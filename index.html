
<!DOCTYPE html><html lang="en"><head>    <meta charset="UTF-8">    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <title>Reported Speech: Questions Challenge</title>    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap" rel="stylesheet">    <style>        :root { --primary: #a29bfe; --success: #00b894; --error: #ff7675; --warning: #fdcb6e; }        body {             font-family: 'Poppins', sans-serif; margin: 0; height: 100vh; display: flex; justify-content: center; align-items: center;            background: linear-gradient(rgba(0,0,0,0.85), rgba(0,0,0,0.85)), url('https://images.unsplash.com/photo-1456513080510-7bf3a84b82f8?auto=format&fit=crop&w=1920&q=80');            background-size: cover; color: white; overflow: hidden;        }        .quiz-container {             background: rgba(255, 255, 255, 0.08); backdrop-filter: blur(15px); padding: 40px; border-radius: 25px;             width: 95%; max-width: 850px; text-align: center; border: 1px solid rgba(255,255,255,0.1);            max-height: 90vh; overflow-y: auto;        }        #timer { font-size: 1.8rem; color: var(--warning); margin-bottom: 15px; }        .progress-container { display: flex; height: 8px; width: 100%; background: rgba(255,255,255,0.1); border-radius: 10px; margin-bottom: 30px; }        .progress-segment { flex: 1; border-right: 1px solid rgba(0,0,0,0.2); transition: 0.4s; }        .direct-quote { font-size: 0.9rem; color: var(--primary); text-transform: uppercase; font-weight: 600; margin-bottom: 10px; }        .reported-sentence { font-size: 1.3rem; margin-bottom: 30px; }        input[type="text"] {            background: transparent; border: none; border-bottom: 2px solid var(--primary); color: #fff;            font-size: 1.3rem; text-align: center; width: 400px; outline: none; margin-bottom: 10px;        }        #next-btn {             padding: 15px 45px; background: var(--primary); color: #2d3436; border: none;             border-radius: 8px; cursor: pointer; font-weight: bold; font-size: 1rem; margin-top: 10px;        }        .review-item { text-align: left; background: rgba(255,255,255,0.1); padding: 15px; border-radius: 15px; margin-bottom: 10px; border-left: 5px solid var(--error); font-size: 0.9rem; }        .hidden { display: none; }    </style></head><body>

<div class="quiz-container">
    <div id="start-screen">
        <h2 style="color: var(--primary);">Reported Questions Master</h2>
        <p>Convert the direct questions into reported speech.</p>
        <input type="text" id="student-name" placeholder="Enter Full Name" style="width: 80%; border: 2px solid var(--primary); border-radius: 10px; padding: 10px; margin-bottom: 20px;">
        <br>
        <button id="next-btn" onclick="startQuiz()">Start Quiz</button>
    </div>

    <div id="main-quiz" class="hidden">
        <div id="timer">05:00</div>
        <div class="progress-container" id="progress-bar"></div>
        <div id="quiz-content">
            <p class="direct-quote" id="active-text"></p>
            <div class="reported-sentence" id="passive-display"></div>
            <div id="feedback" style="min-height: 50px; font-weight: 600;"></div>
            <button id="next-btn" onclick="handleButtonClick()">Check Answer</button>
        </div>
    </div>
</div>

<script>
    const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbzjaoBxGbsuMNHNvenbb_3wAw1XKuGLHSFoSHbvT3NL0zAkFbWSppPQVyYLxjTxCJFp/exec";
    
    const questionBank = [
        { direct: "“Did you finish this report yesterday?”", pre: "She asked him", post: ".", ans: "if he had finished that report the day before" },
        { direct: "“Will you visit me next week?”", pre: "He asked her", post: ".", ans: "if she would visit him the following week" },
        { direct: "“Why did you buy this car?”", pre: "I asked her", post: ".", ans: "why she had bought that car" },
        { direct: "“Where are you going tomorrow?”", pre: "The boss asked me", post: ".", ans: "where I was going the following day" },
        { direct: "“Do you like this new office?”", pre: "They asked us", post: ".", ans: "if we liked that new office" },
        { direct: "“What did you do last week?”", pre: "She asked them", post: ".", ans: "what they had done the week before" },
        { direct: "“Can you fix this computer?”", pre: "He asked the technician", post: ".", ans: "if he could fix that computer" },
        { direct: "“Have you seen this movie before?”", pre: "She asked me", post: ".", ans: "if I had seen that movie before" },
        { direct: "“Who called you yesterday?”", pre: "My mom asked me", post: ".", ans: "who had called me the day before" },
        { direct: "“Are you coming to this party tonight?”", pre: "He asked his friend", post: ".", ans: "if he was coming to that party that night" },
        { direct: "“When will they complete this project?”", pre: "The client asked him", post: ".", ans: "when they would complete that project" },
        { direct: "“How did you find this information?”", pre: "The teacher asked her", post: ".", ans: "how she had found that information" },
        { direct: "“Does she know about this meeting tomorrow?”", pre: "I asked him", post: ".", ans: "if she knew about that meeting the following day" },
        { direct: "“Why is this door locked?”", pre: "She asked the guard", post: ".", ans: "why that door was locked" },
        { direct: "“Did they arrive last week?”", pre: "We asked her", post: ".", ans: "if they had arrived the week before" },
        { direct: "“Where did you leave this bag?”", pre: "He asked me", post: ".", ans: "where I had left that bag" },
        { direct: "“Will you help me with this tomorrow?”", pre: "She asked him", post: ".", ans: "if he would help her with that the following day" },
        { direct: "“What time does this shop open?”", pre: "I asked them", post: ".", ans: "what time that shop opened" },
        { direct: "“Did you see him yesterday?”", pre: "She asked her brother", post: ".", ans: "if he had seen him the day before" },
        { direct: "“Are you using this laptop now?”", pre: "He asked me", post: ".", ans: "if I was using that laptop then" }
    ];

    let currentQ = 0, score = 0, quizData = [], timeLeft = 300, timerId;
    let studentName = "", mistakes = [];

    function startQuiz() {
        studentName = document.getElementById('student-name').value.trim();
        if (!studentName) { alert("Please enter your name."); return; }
        document.getElementById('start-screen').classList.add('hidden');
        document.getElementById('main-quiz').classList.remove('hidden');
        initQuiz();
    }

    function initQuiz() {
        quizData = questionBank.sort(() => 0.5 - Math.random()).slice(0, 10);
        const bar = document.getElementById('progress-bar');
        bar.innerHTML = '';
        for(let i=0; i<10; i++) {
            let seg = document.createElement('div');
            seg.className = 'progress-segment';
            seg.id = 'seg-'+i;
            bar.appendChild(seg);
        }
        startTimer();
        loadQuestion();
    }

    function startTimer() {
        timerId = setInterval(() => {
            timeLeft--;
            let m = Math.floor(timeLeft/60), s = timeLeft%60;
            document.getElementById('timer').innerText = `${m}:${s < 10 ? '0'+s : s}`;
            if(timeLeft <= 0) finish();
        }, 1000);
    }

    function loadQuestion() {
        const q = quizData[currentQ];
        document.getElementById('active-text').innerText = "Direct: " + q.direct;
        document.getElementById('passive-display').innerHTML = `${q.pre} <input type="text" id="ans-input" autocomplete="off"> ${q.post}`;
        document.getElementById('feedback').innerText = '';
        document.getElementById('ans-input').focus();
        document.getElementById('next-btn').innerText = "Check Answer";
    }

    function handleButtonClick() {
        const input = document.getElementById('ans-input');
        if(!input) return;

        if(input.disabled) {
            currentQ++;
            if(currentQ < 10) loadQuestion(); else finish();
            return;
        }

        const user = input.value.trim().toLowerCase().replace(/[.?]$/,"");
        const correct = quizData[currentQ].ans.toLowerCase();
        const seg = document.getElementById('seg-'+currentQ);

        if(user === correct) {
            document.getElementById('feedback').innerHTML = "<span style='color:var(--success)'>Correct!</span>";
            seg.style.background = 'var(--success)';
            score++;
        } else {
            document.getElementById('feedback').innerHTML = `<span style='color:var(--error)'>Incorrect: ...${quizData[currentQ].ans}</span>`;
            seg.style.background = 'var(--error)';
            mistakes.push({ direct: quizData[currentQ].direct, user: user || "(blank)", correct: quizData[currentQ].ans });
        }
        input.disabled = true;
        document.getElementById('next-btn').innerText = "Next Question";
    }

    function finish() {
        clearInterval(timerId);
        const percent = (score / 10) * 100;
        
        let analysisHtml = "";
        if(mistakes.length > 0) {
            analysisHtml = '<h3 style="margin-top:20px;">Mistakes Analysis:</h3>';
            mistakes.forEach(m => {
                analysisHtml += `<div class="review-item">
                    <strong>Direct:</strong> ${m.direct}<br>
                    <span style="color:var(--error); text-decoration:line-through;">Your answer: ${m.user}</span><br>
                    <span style="color:var(--success);">Correct answer: ${m.correct}</span>
                </div>`;
            });
        }

        document.getElementById('quiz-content').innerHTML = `
            <h2>Finished!</h2>
            <p style="font-size:3rem; margin:10px 0;">${percent}%</p>
            <p>${studentName}, you scored ${score}/10</p>
            <div style="max-height:250px; overflow-y:auto; margin-bottom:20px;">${analysisHtml}</div>
            <button onclick="location.reload()" id="next-btn">Try Again</button>
        `;

        try {
            const mistakesText = mistakes.map(m => `Direct: ${m.direct} | User: ${m.user} | Correct: ${m.correct}`).join("\n");
            fetch(SCRIPT_URL, { 
                method: "POST", 
                mode: "no-cors", 
                body: JSON.stringify({ name: studentName, score: score, percentage: percent + "%", mistakes: mistakesText }) 
            });
        } catch (e) { console.log("Data error"); }
    }
</script></body></html>
